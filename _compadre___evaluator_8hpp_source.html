<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Compadre: /home/runner/work/compadre/compadre/src/Compadre_Evaluator.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Compadre
   &#160;<span id="projectnumber">1.6.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Compadre_Evaluator.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_compadre___evaluator_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// @HEADER</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//     Compadre: COMpatible PArticle Discretization and REmap Toolkit</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// Copyright 2018 NTESS and the Compadre contributors.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// SPDX-License-Identifier: BSD-2-Clause</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// *****************************************************************************</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// @HEADER</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef _COMPADRE_EVALUATOR_HPP_</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define _COMPADRE_EVALUATOR_HPP_</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_compadre___typedefs_8hpp.html">Compadre_Typedefs.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_compadre___g_m_l_s_8hpp.html">Compadre_GMLS.hpp</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_compadre___neighbor_lists_8hpp.html">Compadre_NeighborLists.hpp</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespace_compadre.html">Compadre</a> {</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//! Creates 1D subviews of data from a 2D view, generally constructed with CreateNDSliceOnDeviceView</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> T2, <span class="keyword">typename</span> T3=<span class="keywordtype">void</span>&gt;</div>
<div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html">   20</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_compadre_1_1_subview_n_d.html">SubviewND</a> { </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">   22</a></span>&#160;    T <a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>;</div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">   23</a></span>&#160;    T2 <a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">   24</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#a7284ec8e1e8fdd504220bd888e9c4d49">   26</a></span>&#160;    <a class="code" href="struct_compadre_1_1_subview_n_d.html#a7284ec8e1e8fdd504220bd888e9c4d49">SubviewND</a>(T data_in, T2 data_original_view, <span class="keywordtype">bool</span> scalar_as_vector_if_needed) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a> = data_in;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a> = data_original_view;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a> = scalar_as_vector_if_needed; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#aba18f59455c7ee5b83e0b774cd14a66a">   32</a></span>&#160;    <span class="keyword">auto</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html#aba18f59455c7ee5b83e0b774cd14a66a">get1DView</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> column_num) -&gt; decltype(Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, column_num)) {</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a>) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(((<span class="keywordtype">size_t</span>)column_num&lt;<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>.extent(1)) </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;                    &amp;&amp; <span class="stringliteral">&quot;Subview asked for column &gt; second dimension of input data.&quot;</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        }</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)column_num&lt;<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>.extent(1))</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;            <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, column_num);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        <span class="keywordflow">else</span> <span class="comment">// scalar treated as a vector (being reused for each component of the vector input that was expected)</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;            <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, 0);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#a7382e354c4f6108447152930112ebf1b">   43</a></span>&#160;    <span class="keyword">auto</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html#a7382e354c4f6108447152930112ebf1b">get2DView</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> column_num, <span class="keyword">const</span> <span class="keywordtype">int</span> block_size) -&gt; decltype(Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                Kokkos::make_pair(column_num*block_size, (column_num+1)*block_size))) {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a>) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(((<span class="keywordtype">size_t</span>)((column_num+1)*block_size-1)&lt;<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>.extent(1)) </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                    &amp;&amp; <span class="stringliteral">&quot;Subview asked for column &gt; second dimension of input data.&quot;</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        }</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        <span class="keywordflow">if</span> ((<span class="keywordtype">size_t</span>)((column_num+1)*block_size-1)&lt;<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>.extent(1)) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;            <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, Kokkos::make_pair(column_num*block_size, (column_num+1)*block_size));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(((<span class="keywordtype">size_t</span>)(block_size-1)&lt;<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>.extent(1)) &amp;&amp; <span class="stringliteral">&quot;Subview asked for column &gt; second dimension of input data.&quot;</span>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL, Kokkos::make_pair(0,block_size));</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    }</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d.html#ac3d1da3c5e443aed7d45fbf939e0fb50">   57</a></span>&#160;    T2 <a class="code" href="struct_compadre_1_1_subview_n_d.html#ac3d1da3c5e443aed7d45fbf939e0fb50">copyToAndReturnOriginalView</a>() {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        Kokkos::deep_copy(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a>, <a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;};</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">//! Creates 1D subviews of data from a 1D view, generally constructed with CreateNDSliceOnDeviceView</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> T2&gt;</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html">   67</a></span>&#160;<span class="keyword">struct </span><a class="code" href="struct_compadre_1_1_subview_n_d.html">SubviewND</a>&lt;T, T2, <a class="code" href="_compadre___typedefs_8hpp.html#a7fb359b76dd16c0303cd3c673e7415de">enable_if_t</a>&lt;(T::rank&lt;2)&gt; &gt;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;{ </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a680a8dc5f6de80c8514b820c45dee872">   70</a></span>&#160;    T <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a680a8dc5f6de80c8514b820c45dee872">_data_in</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a891048802b16863e0c6aa0ed42c789dd">   71</a></span>&#160;    T2 <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a891048802b16863e0c6aa0ed42c789dd">_data_original_view</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a4890832b84c5416c893ab84c44682a8e">   72</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a4890832b84c5416c893ab84c44682a8e">_scalar_as_vector_if_needed</a>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#aecec7be3768b6c3c4a3cbcf1f9bd54a0">   74</a></span>&#160;    <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#aecec7be3768b6c3c4a3cbcf1f9bd54a0">SubviewND</a>(T data_in, T2 data_original_view, <span class="keywordtype">bool</span> scalar_as_vector_if_needed) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a> = data_in;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a> = data_original_view;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        <a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a> = scalar_as_vector_if_needed; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#ac13b0c0d84b86d3ea09540fe90872b78">   80</a></span>&#160;    <span class="keyword">auto</span> <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#ac13b0c0d84b86d3ea09540fe90872b78">get1DView</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> column_num) -&gt; decltype(Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL)) {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// TODO: There is a valid use case for violating this assert, so in the future we may want</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// to add other logic to the evaluator function calling this so that it knows to do nothing with</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// this data.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <span class="keywordflow">if</span> (!<a class="code" href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">_scalar_as_vector_if_needed</a>) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>((column_num==0) &amp;&amp; <span class="stringliteral">&quot;Subview asked for column column_num!=0, but _data_in is rank 1.&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a3c5f8e6060b341fad3bea4d5e2c8af8d">   90</a></span>&#160;    <span class="keyword">auto</span> <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a3c5f8e6060b341fad3bea4d5e2c8af8d">get2DView</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> column_num, <span class="keyword">const</span> <span class="keywordtype">int</span> block_size) -&gt; decltype(Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL)) {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#aff8e081c413b59ef75c10156c2aef649">compadre_assert_release</a>((block_size==1) &amp;&amp; <span class="stringliteral">&quot;2D subview requested not compatible with one column.&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> Kokkos::subview(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>, Kokkos::ALL);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a6094fbd245294e8badd6605ae304714a">   95</a></span>&#160;    T2 <a class="code" href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a6094fbd245294e8badd6605ae304714a">copyToAndReturnOriginalView</a>() {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        Kokkos::deep_copy(<a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a>, <a class="code" href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">_data_in</a>);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">_data_original_view</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    }</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;};</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">//! Copies data_in to the device, and then allows for access to 1D columns of data on device.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">//! Handles either 2D or 1D views as input, and they can be on the host or the device.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">  106</a></span>&#160;<span class="keyword">auto</span> <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(T sampling_input_data_host_or_device, <span class="keywordtype">bool</span> scalar_as_vector_if_needed) -&gt; <a class="code" href="struct_compadre_1_1_subview_n_d.html">SubviewND</a>&lt;decltype(Kokkos::create_mirror_view(</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    <a class="code" href="_compadre___typedefs_8hpp.html#ac42c70243721f587611ca41df3f2bbbf">device_memory_space</a>(), sampling_input_data_host_or_device)), T&gt; {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// makes view on the device (does nothing if already on the device)</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keyword">auto</span> sampling_input_data_device = Kokkos::create_mirror_view(</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ac42c70243721f587611ca41df3f2bbbf">device_memory_space</a>(), sampling_input_data_host_or_device);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    Kokkos::deep_copy(sampling_input_data_device, sampling_input_data_host_or_device);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    Kokkos::fence();</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="struct_compadre_1_1_subview_n_d.html">SubviewND&lt;decltype(sampling_input_data_device),T&gt;</a>(sampling_input_data_device, </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            sampling_input_data_host_or_device, scalar_as_vector_if_needed);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;}</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">//! \brief Lightweight Evaluator Helper</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">//! This class is a lightweight wrapper for extracting and applying all relevant data from a GMLS class</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">//! in order to transform data into a form that can be acted on by the GMLS operator, apply the action of</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">//! the GMLS operator, and then transform data again (only if on a manifold)</span></div>
<div class="line"><a name="l00123"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html">  123</a></span>&#160;<span class="comment"></span><span class="keyword">class </span><a class="code" href="class_compadre_1_1_evaluator.html">Evaluator</a> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">  127</a></span>&#160;    <a class="code" href="class_compadre_1_1_g_m_l_s.html">GMLS</a> *<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a73a4d6cc3a2fbd1f2ad6d27a2f89a4f5">  132</a></span>&#160;    <a class="code" href="class_compadre_1_1_evaluator.html#a73a4d6cc3a2fbd1f2ad6d27a2f89a4f5">Evaluator</a>(<a class="code" href="class_compadre_1_1_g_m_l_s.html">GMLS</a> *gmls) : <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>(gmls) {</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    };</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a369b5a1a21224fb51045f0f3b132b745">  136</a></span>&#160;    <a class="code" href="class_compadre_1_1_evaluator.html#a369b5a1a21224fb51045f0f3b132b745">~Evaluator</a>() {};</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">    //! Dot product of alphas with sampling data, FOR A SINGLE target_index,  where sampling data is in a 1D/2D Kokkos View</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">    //! This function is to be used when the alpha values have already been calculated and stored for use </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">    //! Only supports one output component / input component at a time. The user will need to loop over the output </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">    //! components in order to fill a vector target or matrix target.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">    //! \param sampling_input_data      [in] - 1D/2D Kokkos View (no restriction on memory space)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">    //! \param column_of_input          [in] - Column of sampling_input_data to use for this input component</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">    //! \param lro                      [in] - Target operation from the TargetOperation enum</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">    //! \param target_index             [in] - Target # user wants to reconstruct target functional at, corresponds to row number of neighbor_lists</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">    //! \param output_component_axis_1  [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar output</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">    //! \param output_component_axis_2  [in] - Columns for a rank 2 tensor, 0 for rank less than 2 output tensor</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">    //! \param input_component_axis_1   [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar input</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">    //! \param input_component_axis_2   [in] - Columns for a rank 2 tensor, 0 for rank less than 2 input tensor</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">    //! \param scalar_as_vector_if_needed [in] - If a 1D view is given, where a 2D view is expected (scalar values given where a vector was expected), then the scalar will be repeated for as many components as the vector has</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_data&gt;</div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a67c605450c74a300cb3d8f511ab74fe1">  156</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="class_compadre_1_1_evaluator.html#a67c605450c74a300cb3d8f511ab74fe1">applyAlphasToDataSingleComponentSingleTargetSite</a>(view_type_data sampling_input_data, <span class="keyword">const</span> <span class="keywordtype">int</span> column_of_input, <a class="code" href="namespace_compadre.html#ac613f05c82282085cc91ecb265feeed2">TargetOperation</a> lro, <span class="keyword">const</span> <span class="keywordtype">int</span> target_index, <span class="keyword">const</span> <span class="keywordtype">int</span> evaluation_site_local_index, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_2, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_2, <span class="keywordtype">bool</span> scalar_as_vector_if_needed = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordtype">double</span> value = 0;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> alpha_input_output_component_index = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a717252cf703df32e07c33f10b9866894">_h_ss</a>.<a class="code" href="struct_compadre_1_1_solution_set.html#a69f84c6ef513c569c9c6c59776cd4366">getAlphaColumnOffset</a>(lro, output_component_axis_1, </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                output_component_axis_2, input_component_axis_1, input_component_axis_2, evaluation_site_local_index);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keyword">auto</span> sampling_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(sampling_input_data, scalar_as_vector_if_needed);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="keyword">auto</span> alphas = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a680694e7642189b994fda25a55323ff5">getSolutionSetDevice</a>()-&gt;getAlphas();</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">auto</span> sampling_data_device = sampling_subview_maker.get1DView(column_of_input);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">auto</span> alpha_index = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a717252cf703df32e07c33f10b9866894">_h_ss</a>.<a class="code" href="struct_compadre_1_1_solution_set.html#a191f63f135478c2cd76de23a14783a9e">getAlphaIndex</a>(target_index, alpha_input_output_component_index);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// loop through neighbor list for this target_index</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// grabbing data from that entry of data</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        Kokkos::parallel_reduce(<span class="stringliteral">&quot;applyAlphasToData::Device&quot;</span>, </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                Kokkos::RangePolicy&lt;device_execution_space&gt;(0,nla.getNumberOfNeighborsHost(target_index)), </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                KOKKOS_LAMBDA(<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span>&amp; t_value) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            t_value += sampling_data_device(nla.getNeighborDevice(target_index, i))</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                *alphas(alpha_index + i);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        }, value );</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    }</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">    //! Dot product of alphas with sampling data where sampling data is in a 1D/2D Kokkos View and output view is also </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">    //! a 1D/2D Kokkos View, however THE SAMPLING DATA and OUTPUT VIEW MUST BE ON THE DEVICE!</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">    //! This function is to be used when the alpha values have already been calculated and stored for use.</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">    //! Only supports one output component / input component at a time. The user will need to loop over the output </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">    //! components in order to fill a vector target or matrix target.</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">    //! \param output_data_single_column       [out] - 1D Kokkos View (memory space must be device_memory_space())</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">    //! \param sampling_data_single_column      [in] - 1D Kokkos View (memory space must match output_data_single_column)</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">    //! \param lro                              [in] - Target operation from the TargetOperation enum</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">    //! \param sro                              [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">    //! \param evaluation_site_local_index      [in] - local column index of site from additional evaluation sites list or 0 for the target site</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">    //! \param output_component_axis_1          [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar output</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">    //! \param output_component_axis_2          [in] - Columns for a rank 2 tensor, 0 for rank less than 2 output tensor</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">    //! \param input_component_axis_1           [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar input</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">    //! \param input_component_axis_2           [in] - Columns for a rank 2 tensor, 0 for rank less than 2 input tensor</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">    //! \param pre_transform_local_index        [in] - For manifold problems, this is the local coordinate direction that sampling data may need to be transformed to before the application of GMLS</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">    //! \param pre_transform_global_index       [in] - For manifold problems, this is the global coordinate direction that sampling data can be represented in</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">    //! \param post_transform_local_index       [in] - For manifold problems, this is the local coordinate direction that vector output target functionals from GMLS will output into</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">    //! \param post_transform_global_index      [in] - For manifold problems, this is the global coordinate direction that the target functional output from GMLS will be transformed into</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">    //! \param transform_output_ambient         [in] - Whether or not a 1D output from GMLS is on the manifold and needs to be mapped to ambient space</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">    //! \param vary_on_target                   [in] - Whether the sampling functional has a tensor to act on sampling data that varies with each target site</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">    //! \param vary_on_neighbor                 [in] - Whether the sampling functional has a tensor to act on sampling data that varies with each neighbor site in addition to varying wit each target site</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_data_out, <span class="keyword">typename</span> view_type_data_in&gt;</div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">  213</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform</a>(view_type_data_out output_data_single_column, view_type_data_in sampling_data_single_column, <a class="code" href="namespace_compadre.html#ac613f05c82282085cc91ecb265feeed2">TargetOperation</a> lro, <span class="keyword">const</span> <a class="code" href="struct_compadre_1_1_sampling_functional.html">SamplingFunctional</a> sro, <span class="keyword">const</span> <span class="keywordtype">int</span> evaluation_site_local_index, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_2, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_2, <span class="keyword">const</span> <span class="keywordtype">int</span> pre_transform_local_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> pre_transform_global_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> post_transform_local_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> post_transform_global_index = -1, <span class="keywordtype">bool</span> vary_on_target = <span class="keyword">false</span>, <span class="keywordtype">bool</span> vary_on_neighbor = <span class="keyword">false</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> alpha_input_output_component_index = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a717252cf703df32e07c33f10b9866894">_h_ss</a>.<a class="code" href="struct_compadre_1_1_solution_set.html#a69f84c6ef513c569c9c6c59776cd4366">getAlphaColumnOffset</a>(lro, output_component_axis_1, </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                output_component_axis_2, input_component_axis_1, input_component_axis_2, evaluation_site_local_index);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> alpha_input_output_component_index2 = alpha_input_output_component_index;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keyword">auto</span> solution_set = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a680694e7642189b994fda25a55323ff5">getSolutionSetDevice</a>());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#aff8e081c413b59ef75c10156c2aef649">compadre_assert_release</a>(solution_set._contains_valid_alphas &amp;&amp; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="stringliteral">&quot;application of alphas called before generateAlphas() was called.&quot;</span>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keyword">auto</span> prestencil_weights = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aff8cbcdf4715eba368b7a2d92c76b754">getPrestencilWeights</a>();</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_targets = nla.getNumberOfTargets();</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">// make sure input and output views have same memory space</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>((std::is_same&lt;typename view_type_data_out::memory_space, typename view_type_data_in::memory_space&gt;::value) &amp;&amp; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="stringliteral">&quot;output_data_single_column view and input_data_single_column view have difference memory spaces.&quot;</span>);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordtype">bool</span> weight_with_pre_T = (pre_transform_local_index&gt;=0 &amp;&amp; pre_transform_global_index&gt;=0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        <span class="keywordtype">bool</span> target_plus_neighbor_staggered_schema = sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#aabb0fc876ab4a05c221c446665af3b5c">use_target_site_weights</a>;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        <span class="comment">// loops over target indices</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        Kokkos::parallel_for(<a class="code" href="_compadre___typedefs_8hpp.html#a780a197019fb46228d76d52b97d59907">team_policy</a>(num_targets, Kokkos::AUTO),</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                KOKKOS_LAMBDA(<span class="keyword">const</span> <a class="code" href="_compadre___typedefs_8hpp.html#ab6b3943cff6b6b9a98a1dc4f7c87393d">member_type</a>&amp; teamMember) {</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> target_index = teamMember.league_rank();</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            teamMember.team_barrier();</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> previous_value = output_data_single_column(target_index);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="comment">// loops over neighbors of target_index</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="keyword">auto</span> alpha_index = solution_set.getAlphaIndex(target_index, alpha_input_output_component_index);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="keywordtype">double</span> gmls_value = 0;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            Kokkos::parallel_reduce(Kokkos::TeamThreadRange(teamMember, nla.getNumberOfNeighborsDevice(target_index)), [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span>&amp; t_value) {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                const double neighbor_varying_pre_T =  (weight_with_pre_T &amp;&amp; vary_on_neighbor) ?</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    prestencil_weights(0, target_index, i, pre_transform_local_index, pre_transform_global_index)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    : 1.0;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                t_value += neighbor_varying_pre_T * sampling_data_single_column(nla.getNeighborDevice(target_index, i))</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                            *solution_set._alphas(alpha_index + i);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            }, gmls_value );</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="comment">// data contract for sampling functional</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="keywordtype">double</span> pre_T = 1.0;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="keywordflow">if</span> (weight_with_pre_T) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                <span class="keywordflow">if</span> (!vary_on_neighbor &amp;&amp; vary_on_target) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    pre_T = prestencil_weights(0, target_index, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                            pre_transform_global_index); </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!vary_on_target) { <span class="comment">// doesn&#39;t vary on target or neighbor</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    pre_T = prestencil_weights(0, 0, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                            pre_transform_global_index); </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordtype">double</span> staggered_value_from_targets = 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="keywordtype">double</span> pre_T_staggered = 1.0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            <span class="keyword">auto</span> alpha_index2 = solution_set.getAlphaIndex(target_index, alpha_input_output_component_index2);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="comment">// loops over target_index for each neighbor for staggered approaches</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (target_plus_neighbor_staggered_schema) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                Kokkos::parallel_reduce(Kokkos::TeamThreadRange(teamMember, nla.getNumberOfNeighborsDevice(target_index)), [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span>&amp; t_value) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                    const double neighbor_varying_pre_T_staggered =  (weight_with_pre_T &amp;&amp; vary_on_neighbor) ?</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                        prestencil_weights(1, target_index, i, pre_transform_local_index, pre_transform_global_index)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                        : 1.0;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                    t_value += neighbor_varying_pre_T_staggered * sampling_data_single_column(nla.getNeighborDevice(target_index, 0))</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                                *solution_set._alphas(alpha_index2 + i);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                }, staggered_value_from_targets );</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <span class="comment">// for staggered approaches that transform source data for the target and neighbors</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordflow">if</span> (weight_with_pre_T) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    <span class="keywordflow">if</span> (!vary_on_neighbor &amp;&amp; vary_on_target) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                        pre_T_staggered = prestencil_weights(1, target_index, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                pre_transform_global_index); </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!vary_on_target) { <span class="comment">// doesn&#39;t vary on target or neighbor</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        pre_T_staggered = prestencil_weights(1, 0, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                pre_transform_global_index); </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; </div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordtype">double</span> added_value = pre_T*gmls_value + pre_T_staggered*staggered_value_from_targets;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            Kokkos::single(Kokkos::PerTeam(teamMember), [&amp;] () {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                output_data_single_column(target_index) = previous_value + added_value;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            });</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        });</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">    //! Postprocessing for manifolds. Maps local chart vector solutions to ambient space.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">    //! THE SAMPLING DATA and OUTPUT VIEW MUST BE ON THE DEVICE!</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">    //! Only supports one output component / input component at a time. The user will need to loop over the output </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">    //! components in order to transform a vector target.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment">    //! \param output_data_single_column       [out] - 1D Kokkos View (memory space must be device_memory_space())</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">    //! \param sampling_data_single_column      [in] - 1D Kokkos View (memory space must match output_data_single_column)</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">    //! \param local_dim_index                  [in] - For manifold problems, this is the local coordinate direction that sampling data may need to be transformed to before the application of GMLS</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment">    //! \param global_dim_index                 [in] - For manifold problems, this is the global coordinate direction that sampling data can be represented in</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_data_out, <span class="keyword">typename</span> view_type_data_in&gt;</div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a5d17f7937bdf527946dd82f22c3131ea">  317</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_compadre_1_1_evaluator.html#a5d17f7937bdf527946dd82f22c3131ea">applyLocalChartToAmbientSpaceTransform</a>(view_type_data_out output_data_single_column, view_type_data_in sampling_data_single_column, <span class="keyword">const</span> <span class="keywordtype">int</span> local_dim_index, <span class="keyword">const</span> <span class="keywordtype">int</span> global_dim_index)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        <span class="comment">// Does T transpose times a vector</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keyword">auto</span> global_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">getGlobalDimensions</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_targets = nla.getNumberOfTargets();</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keyword">auto</span> tangent_directions = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#ab823746d56dcb6a87a830c3a84169b66">getTangentDirections</a>());</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="comment">// make sure input and output views have same memory space</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>((std::is_same&lt;typename view_type_data_out::memory_space, typename view_type_data_in::memory_space&gt;::value) &amp;&amp; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="stringliteral">&quot;output_data_single_column view and input_data_single_column view have difference memory spaces.&quot;</span>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment">// loops over target indices</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        Kokkos::parallel_for(<a class="code" href="_compadre___typedefs_8hpp.html#a780a197019fb46228d76d52b97d59907">team_policy</a>(num_targets, Kokkos::AUTO),</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                KOKKOS_LAMBDA(<span class="keyword">const</span> <a class="code" href="_compadre___typedefs_8hpp.html#ab6b3943cff6b6b9a98a1dc4f7c87393d">member_type</a>&amp; teamMember) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> target_index = teamMember.league_rank();</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ae10044c07bbc70fddbbb3612cb4657cc">scratch_matrix_right_type</a> T</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    (tangent_directions.data() + <a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(target_index)*<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(global_dimensions)*<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(global_dimensions), </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                     global_dimensions, global_dimensions);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;            teamMember.team_barrier();</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> previous_value = output_data_single_column(target_index);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            <span class="keywordtype">double</span> added_value = T(local_dim_index, global_dim_index)*sampling_data_single_column(target_index);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            Kokkos::single(Kokkos::PerTeam(teamMember), [&amp;] () {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                output_data_single_column(target_index) = previous_value + added_value;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            });</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        });</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        Kokkos::fence();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">    //! Transformation of data under GMLS (allocates memory for output)</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">    //! This function is the go-to function to be used when the alpha values have already been calculated and stored for use. The sampling functional provided instructs how a data transformation tensor is to be used on source data before it is provided to the GMLS operator. Once the sampling functional (if applicable) and the GMLS operator have been applied, this function also handles mapping the local vector back to the ambient space if working on a manifold problem and a target functional who has rank 1 output.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment">    //! Produces a Kokkos View as output with a Kokkos memory_space provided as a template tag by the caller. </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">    //! The data type (double* or double**) must also be specified as a template type if one wish to get a 1D </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">    //! Kokkos View back that can be indexed into with only one ordinal.</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">    //! \param sampling_data              [in] - 1D or 2D Kokkos View that has the layout #targets * columns of data. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">    //! \param lro                        [in] - Target operation from the TargetOperation enum</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">    //! \param sro_in                     [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">    //! \param scalar_as_vector_if_needed [in] - If a 1D view is given, where a 2D view is expected (scalar values given where a vector was expected), then the scalar will be repeated for as many components as the vector has</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">    //! \param evaluation_site_local_index [in] - 0 corresponds to evaluating at the target site itself, while a number larger than 0 indicates evaluation at a site other than the target, and specified by calling setAdditionalEvaluationSitesData on the GMLS class</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> output_data_type = <span class="keywordtype">double</span>**, <span class="keyword">typename</span> output_memory_space, <span class="keyword">typename</span> view_type_input_data, <span class="keyword">typename</span> output_array_layout = <span class="keyword">typename</span> view_type_input_data::array_layout&gt;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    Kokkos::View&lt;output_data_type, output_array_layout, output_memory_space&gt;  <span class="comment">// shares layout of input by default</span></div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a53af29898f3db02a84bb7a17ab8fb5d8">  370</a></span>&#160;            <a class="code" href="class_compadre_1_1_evaluator.html#a53af29898f3db02a84bb7a17ab8fb5d8">applyAlphasToDataAllComponentsAllTargetSites</a>(view_type_input_data sampling_data, <a class="code" href="namespace_compadre.html#ac613f05c82282085cc91ecb265feeed2">TargetOperation</a> lro, <span class="keyword">const</span> <a class="code" href="struct_compadre_1_1_sampling_functional.html">SamplingFunctional</a> sro_in = <a class="code" href="namespace_compadre.html#a5f6ebcec2ee2b0b9c4e5ad56432e7ffe">PointSample</a>, <span class="keywordtype">bool</span> scalar_as_vector_if_needed = <span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">int</span> evaluation_site_local_index = 0)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// determines the number of columns needed for output after action of the target functional</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keyword">auto</span> local_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a21eddec4f0de93afe50788a7d0a8d29f">getLocalDimensions</a>();</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        <span class="keyword">auto</span> global_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">getGlobalDimensions</a>();</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        <span class="keywordtype">int</span> output_dimensions = <a class="code" href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">getOutputDimensionOfOperation</a>(lro, local_dimensions);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <span class="keyword">auto</span> problem_type = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#ad62dc664f468f64c422e665b4245cbf4">getProblemType</a>();</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keyword">typedef</span> Kokkos::View&lt;output_data_type, output_array_layout, output_memory_space&gt; output_view_type;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment">// create view on whatever memory space the user specified with their template argument when calling this function</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        output_view_type target_output = createView&lt;output_view_type&gt;(<span class="stringliteral">&quot;output of target operation&quot;</span>, </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                nla.getNumberOfTargets(), output_dimensions);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        output_view_type ambient_target_output;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordtype">bool</span> transform_gmls_output_to_ambient = (problem_type==<a class="code" href="namespace_compadre.html#a7bcef14eab05ce9b74e76640a660d2e3afb121947b941062d256dfa840e0c9147">MANIFOLD</a> &amp;&amp; <a class="code" href="namespace_compadre.html#a2b30b9fb0daa7592da0bd000bdf52fa8">getTargetOutputTensorRank</a>(lro)==1);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">if</span> (transform_gmls_output_to_ambient) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            ambient_target_output = createView&lt;output_view_type&gt;(<span class="stringliteral">&quot;output of transform to ambient space&quot;</span>, </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                nla.getNumberOfTargets(), global_dimensions);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        }</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <a class="code" href="class_compadre_1_1_evaluator.html#a53af29898f3db02a84bb7a17ab8fb5d8">applyAlphasToDataAllComponentsAllTargetSites</a>(target_output, ambient_target_output, sampling_data, lro, sro_in, scalar_as_vector_if_needed, evaluation_site_local_index);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;        <span class="keywordflow">if</span> (transform_gmls_output_to_ambient) {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">return</span> ambient_target_output;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            <span class="keywordflow">return</span> target_output;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">    //! Transformation of data under GMLS (does not allocate memory for output)</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">    //! If space for the output result is already allocated, this function will populate the output result view (and possibly ambient target output). The sampling functional provided instructs how a data transformation tensor is to be used on source data before it is provided to the GMLS operator. Once the sampling functional (if applicable) and the GMLS operator have been applied, this function also handles mapping the local vector back to the ambient space if working on a manifold problem and a target functional who has rank 1 output.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">    //! Fills a Kokkos View of output. </span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">    //! \param target_output              [in] - 1D or 2D Kokkos View that has the resulting #targets * need output columns. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">    //! \param ambient_target_output      [in] - Same view type as target_output, but dimensions should be #targets * global_dimension if this is being filled (if not being filled, then this can be an empty view)</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">    //! \param sampling_data              [in] - 1D or 2D Kokkos View that has the layout #targets * columns of data. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">    //! \param lro                        [in] - Target operation from the TargetOperation enum</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">    //! \param sro_in                     [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">    //! \param scalar_as_vector_if_needed [in] - If a 1D view is given, where a 2D view is expected (scalar values given where a vector was expected), then the scalar will be repeated for as many components as the vector has</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">    //! \param evaluation_site_local_index [in] - 0 corresponds to evaluating at the target site itself, while a number larger than 0 indicates evaluation at a site other than the target, and specified by calling setAdditionalEvaluationSitesData on the GMLS class</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_output_data, <span class="keyword">typename</span> view_type_input_data, <span class="keyword">typename</span> output_array_layout = <span class="keyword">typename</span> view_type_input_data::array_layout&gt;</div>
<div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#af247b7aacebd49696cdc3966f5cb6b67">  417</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_compadre_1_1_evaluator.html#af247b7aacebd49696cdc3966f5cb6b67">applyAlphasToDataAllComponentsAllTargetSites</a>(view_type_output_data target_output, view_type_output_data ambient_target_output, view_type_input_data sampling_data, <a class="code" href="namespace_compadre.html#ac613f05c82282085cc91ecb265feeed2">TargetOperation</a> lro, <span class="keyword">const</span> <a class="code" href="struct_compadre_1_1_sampling_functional.html">SamplingFunctional</a> sro_in = <a class="code" href="namespace_compadre.html#a5f6ebcec2ee2b0b9c4e5ad56432e7ffe">PointSample</a>, <span class="keywordtype">bool</span> scalar_as_vector_if_needed = <span class="keyword">true</span>, <span class="keyword">const</span> <span class="keywordtype">int</span> evaluation_site_local_index = 0)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        <span class="comment">// output can be device or host</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// input can be device or host</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="comment">// move everything to device and calculate there, then move back to host if necessary</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">auto</span> problem_type = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#ad62dc664f468f64c422e665b4245cbf4">getProblemType</a>();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">auto</span> global_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">getGlobalDimensions</a>();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <span class="keyword">auto</span> local_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a21eddec4f0de93afe50788a7d0a8d29f">getLocalDimensions</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordtype">int</span> output_dimension1_of_operator = (<a class="code" href="namespace_compadre.html#a2b30b9fb0daa7592da0bd000bdf52fa8">getTargetOutputTensorRank</a>(lro)&lt;2) ? <a class="code" href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">getOutputDimensionOfOperation</a>(lro, local_dimensions) : std::sqrt(<a class="code" href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">getOutputDimensionOfOperation</a>(lro, local_dimensions));</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        <span class="keywordtype">int</span> output_dimension2_of_operator = (<a class="code" href="namespace_compadre.html#a2b30b9fb0daa7592da0bd000bdf52fa8">getTargetOutputTensorRank</a>(lro)&lt;2) ? 1 : std::sqrt(<a class="code" href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">getOutputDimensionOfOperation</a>(lro, local_dimensions));</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        <span class="comment">// determines the number of columns needed for output after action of the target functional</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordtype">int</span> output_dimensions = <a class="code" href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">getOutputDimensionOfOperation</a>(lro, local_dimensions);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="comment">// special case for VectorPointSample, because if it is on a manifold it includes data transform to local charts</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keyword">auto</span> sro = (problem_type==<a class="code" href="namespace_compadre.html#a7bcef14eab05ce9b74e76640a660d2e3afb121947b941062d256dfa840e0c9147">MANIFOLD</a> &amp;&amp; sro_in==<a class="code" href="namespace_compadre.html#aa751ff7a0194083792001d714fd7f396">VectorPointSample</a>) ? <a class="code" href="namespace_compadre.html#a9975dd29d2aabf4a76702cc95843523a">ManifoldVectorPointSample</a> : sro_in;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <span class="keywordtype">int</span> input_dimension_of_operator = <a class="code" href="namespace_compadre.html#ab02c592b44da9a6eb95c99546e1191f2">getInputDimensionOfOperation</a>(lro, <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a6d7af37d90db07af703332799b65737f">_data_sampling_functional</a>, local_dimensions);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(target_output.extent(0)==(<span class="keywordtype">size_t</span>)nla.getNumberOfTargets() </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                &amp;&amp; <span class="stringliteral">&quot;First dimension of target_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(target_output.extent(1)==(<span class="keywordtype">size_t</span>)output_dimensions </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                &amp;&amp; <span class="stringliteral">&quot;Second dimension of target_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        <span class="comment">// make sure input and output columns make sense under the target operation</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(((output_dimensions==1 &amp;&amp; view_type_output_data::rank==1) || view_type_output_data::rank!=1) &amp;&amp; </div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                <span class="stringliteral">&quot;Output view is requested as rank 1, but the target requires a rank larger than 1. Try double** as template argument.&quot;</span>);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// we need to specialize a template on the rank of the output view type and the input view type</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keyword">auto</span> sampling_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(sampling_data, scalar_as_vector_if_needed);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keyword">auto</span> output_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(target_output, <span class="keyword">false</span>); <span class="comment">// output will always be the correct dimension</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">// figure out preprocessing and postprocessing</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keyword">auto</span> prestencil_weights = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aff8cbcdf4715eba368b7a2d92c76b754">getPrestencilWeights</a>();</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        <span class="comment">// all loop logic based on transforming data under a sampling functional</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// into something that is valid input for GMLS</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        <span class="keywordtype">bool</span> vary_on_target = <span class="keyword">false</span>, vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <span class="keyword">auto</span> sro_style = sro.transform_type;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        <span class="keywordtype">bool</span> loop_global_dimensions = sro.input_rank&gt;0 &amp;&amp; sro_style!=<a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a>; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#aff8e081c413b59ef75c10156c2aef649">compadre_assert_release</a>((<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aaee5472ba7426b9f2ca764ebd0430c94">getDataSamplingFunctional</a>()==sro || sro_style==<a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a>)</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                &amp;&amp; <span class="stringliteral">&quot;SamplingFunctional requested for Evaluator does not match GMLS data sampling functional or is not of type &#39;Identity&#39;.&quot;</span>);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <span class="keywordflow">if</span> (sro.transform_type == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a> || sro.transform_type == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ab13b06e20f8d36b5346a5781b7c9ce43">SameForAll</a>) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            vary_on_target = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;            vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro.transform_type == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424aa96f53f2ba3817c215344f27b66da798">DifferentEachTarget</a>) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            vary_on_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro.transform_type == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424a4a5f31a07809f6abad03b7d71d9f94a9">DifferentEachNeighbor</a>) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            vary_on_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            vary_on_neighbor = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// only written for up to rank 1 to rank 2 (in / out)</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">// loop over components of output of the target operation</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> axes1=0; axes1&lt;output_dimension1_of_operator; ++axes1) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_1 = axes1;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> axes2=0; axes2&lt;output_dimension2_of_operator; ++axes2) {</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_2 = axes2;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                <span class="comment">// loop over components of input of the target operation</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;input_dimension_of_operator; ++j) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_1 = j;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_2 = 0;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                    <span class="keywordflow">if</span> (loop_global_dimensions) {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;global_dimensions; ++k) { <span class="comment">// loop for handling sampling functional</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                            this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform</a>(</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                                    output_subview_maker.get1DView(axes1*output_dimension2_of_operator+axes2), </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                                    sampling_subview_maker.get1DView(k), lro, sro, </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                    evaluation_site_local_index, output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                    input_component_axis_2, j, k, -1, -1,</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                                    vary_on_target, vary_on_neighbor);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                        }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro_style != <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a>) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                        this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform</a>(</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                                output_subview_maker.get1DView(axes1*output_dimension2_of_operator+axes2), </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                                sampling_subview_maker.get1DView(j), lro, sro, </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                                evaluation_site_local_index, output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                                input_component_axis_2, 0, 0, -1, -1,</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                vary_on_target, vary_on_neighbor);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// standard</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform</a>(</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                                output_subview_maker.get1DView(axes1*output_dimension2_of_operator+axes2), </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                sampling_subview_maker.get1DView(j), lro, sro, </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                evaluation_site_local_index, output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                input_component_axis_2);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                    }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="keywordtype">bool</span> transform_gmls_output_to_ambient = (problem_type==<a class="code" href="namespace_compadre.html#a7bcef14eab05ce9b74e76640a660d2e3afb121947b941062d256dfa840e0c9147">MANIFOLD</a> &amp;&amp; <a class="code" href="namespace_compadre.html#a2b30b9fb0daa7592da0bd000bdf52fa8">getTargetOutputTensorRank</a>(lro)==1);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> (transform_gmls_output_to_ambient) {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            Kokkos::fence();</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(ambient_target_output.extent(0)==(<span class="keywordtype">size_t</span>)nla.getNumberOfTargets() </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                    &amp;&amp; <span class="stringliteral">&quot;First dimension of target_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(ambient_target_output.extent(1)==(<span class="keywordtype">size_t</span>)global_dimensions </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                    &amp;&amp; <span class="stringliteral">&quot;Second dimension of target_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            <span class="keyword">auto</span> transformed_output_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(ambient_target_output, <span class="keyword">false</span>); </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="comment">// output will always be the correct dimension</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;global_dimensions; ++i) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;output_dimensions; ++j) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                    this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a5d17f7937bdf527946dd82f22c3131ea">applyLocalChartToAmbientSpaceTransform</a>(</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                            transformed_output_subview_maker.get1DView(i), output_subview_maker.get1DView(j), j, i);</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                }</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            <span class="comment">// copy back to whatever memory space the user requester through templating from the device</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            Kokkos::deep_copy(ambient_target_output, transformed_output_subview_maker.copyToAndReturnOriginalView());</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="comment">// copy back to whatever memory space the user requester through templating from the device</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        Kokkos::deep_copy(target_output, output_subview_maker.copyToAndReturnOriginalView());</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">    //! Dot product of data with full polynomial coefficient basis where sampling data is in a 1D/2D Kokkos View and output view is also </span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">    //! a 1D/2D Kokkos View, however THE SAMPLING DATA and OUTPUT VIEW MUST BE ON THE DEVICE!</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">    //! This function is to be used when the polynomial coefficient basis has already been calculated and stored for use.</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">    //! Only supports one output component / input component at a time. The user will need to loop over the output </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">    //! components in order to fill a vector target or matrix target.</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">    //! \param output_data_block_column       [out] - 2D Kokkos View (memory space must be device_memory_space())</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">    //! \param sampling_data_single_column      [in] - 1D Kokkos View (memory space must match output_data_single_column)</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">    //! \param sro                              [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">    //! \param target_index                     [in] - Target # user wants to reconstruct target functional at, corresponds to row number of neighbor_lists</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">    //! \param output_component_axis_1          [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar output</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">    //! \param output_component_axis_2          [in] - Columns for a rank 2 tensor, 0 for rank less than 2 output tensor</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">    //! \param input_component_axis_1           [in] - Row for a rank 2 tensor or rank 1 tensor, 0 for a scalar input</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">    //! \param input_component_axis_2           [in] - Columns for a rank 2 tensor, 0 for rank less than 2 input tensor</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">    //! \param pre_transform_local_index        [in] - For manifold problems, this is the local coordinate direction that sampling data may need to be transformed to before the application of GMLS</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">    //! \param pre_transform_global_index       [in] - For manifold problems, this is the global coordinate direction that sampling data can be represented in</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">    //! \param post_transform_local_index       [in] - For manifold problems, this is the local coordinate direction that vector output target functionals from GMLS will output into</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">    //! \param post_transform_global_index      [in] - For manifold problems, this is the global coordinate direction that the target functional output from GMLS will be transformed into</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">    //! \param vary_on_target                   [in] - Whether the sampling functional has a tensor to act on sampling data that varies with each target site</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">    //! \param vary_on_neighbor                 [in] - Whether the sampling functional has a tensor to act on sampling data that varies with each neighbor site in addition to varying wit each target site</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_data_out, <span class="keyword">typename</span> view_type_data_in&gt;</div>
<div class="line"><a name="l00565"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">  565</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">applyFullPolynomialCoefficientsBasisToDataSingleComponent</a>(view_type_data_out output_data_block_column, view_type_data_in sampling_data_single_column, <span class="keyword">const</span> <a class="code" href="struct_compadre_1_1_sampling_functional.html">SamplingFunctional</a> sro, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_2, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_1, <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_2, <span class="keyword">const</span> <span class="keywordtype">int</span> pre_transform_local_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> pre_transform_global_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> post_transform_local_index = -1, <span class="keyword">const</span> <span class="keywordtype">int</span> post_transform_global_index = -1, <span class="keywordtype">bool</span> vary_on_target = <span class="keyword">false</span>, <span class="keywordtype">bool</span> vary_on_neighbor = <span class="keyword">false</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keyword">auto</span> coefficient_matrix_dims = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#adc9c7443a7a1890a3a27308552c9bbec">getPolynomialCoefficientsDomainRangeSize</a>();</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        <span class="keyword">auto</span> coefficient_memory_layout_dims = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a10a4bb458968581849f3cabf93072f5d">getPolynomialCoefficientsMemorySize</a>();</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="keyword">auto</span> coefficient_memory_layout_dims_device = </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;            Kokkos::create_mirror_view_and_copy(<a class="code" href="_compadre___typedefs_8hpp.html#ac42c70243721f587611ca41df3f2bbbf">device_memory_space</a>(), coefficient_memory_layout_dims);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="keyword">auto</span> global_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">getGlobalDimensions</a>();</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keyword">auto</span> coeffs         = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a12269d83757d5de63e5a810a3295621d">getFullPolynomialCoefficientsBasis</a>();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">auto</span> tangent_directions = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#ab823746d56dcb6a87a830c3a84169b66">getTangentDirections</a>());</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keyword">auto</span> prestencil_weights = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aff8cbcdf4715eba368b7a2d92c76b754">getPrestencilWeights</a>();</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_targets = nla.getNumberOfTargets();</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        <span class="comment">// make sure input and output views have same memory space</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>((std::is_same&lt;typename view_type_data_out::memory_space, typename view_type_data_in::memory_space&gt;::value) &amp;&amp; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                <span class="stringliteral">&quot;output_data_block_column view and input_data_single_column view have difference memory spaces.&quot;</span>);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <span class="keywordtype">bool</span> weight_with_pre_T = (pre_transform_local_index&gt;=0 &amp;&amp; pre_transform_global_index&gt;=0) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordtype">bool</span> target_plus_neighbor_staggered_schema = sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#aabb0fc876ab4a05c221c446665af3b5c">use_target_site_weights</a>;</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="comment">// loops over target indices</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;coefficient_matrix_dims(0); ++j) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            Kokkos::parallel_for(<a class="code" href="_compadre___typedefs_8hpp.html#a780a197019fb46228d76d52b97d59907">team_policy</a>(num_targets, Kokkos::AUTO),</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    KOKKOS_LAMBDA(<span class="keyword">const</span> <a class="code" href="_compadre___typedefs_8hpp.html#ab6b3943cff6b6b9a98a1dc4f7c87393d">member_type</a>&amp; teamMember) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> target_index = teamMember.league_rank();</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160; </div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                <a class="code" href="_compadre___typedefs_8hpp.html#ae10044c07bbc70fddbbb3612cb4657cc">scratch_matrix_right_type</a> T (tangent_directions.data() </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                            + <a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(target_index)*<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(global_dimensions)*<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(global_dimensions), </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                         global_dimensions, global_dimensions);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                <a class="code" href="_compadre___typedefs_8hpp.html#ae10044c07bbc70fddbbb3612cb4657cc">scratch_matrix_right_type</a> Coeffs;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                Coeffs = <a class="code" href="_compadre___typedefs_8hpp.html#ae10044c07bbc70fddbbb3612cb4657cc">scratch_matrix_right_type</a>(coeffs.data() </div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                    + <a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(target_index)*<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(coefficient_memory_layout_dims_device(0))</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                        *<a class="code" href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a>(coefficient_memory_layout_dims_device(1)),</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    coefficient_memory_layout_dims_device(0), coefficient_memory_layout_dims_device(1));</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                teamMember.team_barrier();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> previous_value = output_data_block_column(target_index, j);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160; </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                <span class="comment">// loops over neighbors of target_index</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                <span class="keywordtype">double</span> gmls_value = 0;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                Kokkos::parallel_reduce(Kokkos::TeamThreadRange(teamMember, nla.getNumberOfNeighborsDevice(target_index)), [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span>&amp; t_value) {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                    const double neighbor_varying_pre_T =  (weight_with_pre_T &amp;&amp; vary_on_neighbor) ?</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                        prestencil_weights(0, target_index, i, pre_transform_local_index, pre_transform_global_index)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                        : 1.0;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                    t_value += neighbor_varying_pre_T * sampling_data_single_column(nla.getNeighborDevice(target_index, i))</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                        *Coeffs(j, i+input_component_axis_1*nla.getNumberOfNeighborsDevice(target_index));</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                }, gmls_value );</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                <span class="comment">// data contract for sampling functional</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                <span class="keywordtype">double</span> pre_T = 1.0;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">if</span> (weight_with_pre_T) {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                    <span class="keywordflow">if</span> (!vary_on_neighbor &amp;&amp; vary_on_target) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;                        pre_T = prestencil_weights(0, target_index, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                pre_transform_global_index); </div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!vary_on_target) { <span class="comment">// doesn&#39;t vary on target or neighbor</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                        pre_T = prestencil_weights(0, 0, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                                pre_transform_global_index); </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                <span class="keywordtype">double</span> staggered_value_from_targets = 0;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="keywordtype">double</span> pre_T_staggered = 1.0;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                <span class="comment">// loops over target_index for each neighbor for staggered approaches</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordflow">if</span> (target_plus_neighbor_staggered_schema) {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                    Kokkos::parallel_reduce(Kokkos::TeamThreadRange(teamMember, nla.getNumberOfNeighborsDevice(target_index)), [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> i, <span class="keywordtype">double</span>&amp; t_value) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                        const double neighbor_varying_pre_T_staggered =  (weight_with_pre_T &amp;&amp; vary_on_neighbor) ?</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                            prestencil_weights(1, target_index, i, pre_transform_local_index, pre_transform_global_index)</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            : 1.0;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                        t_value += neighbor_varying_pre_T_staggered * sampling_data_single_column(nla.getNeighborDevice(target_index, 0))</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                            *Coeffs(j, i+input_component_axis_1*nla.getNumberOfNeighborsDevice(target_index));</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    }, staggered_value_from_targets );</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    <span class="comment">// for staggered approaches that transform source data for the target and neighbors</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    <span class="keywordflow">if</span> (weight_with_pre_T) {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                        <span class="keywordflow">if</span> (!vary_on_neighbor &amp;&amp; vary_on_target) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            pre_T_staggered = prestencil_weights(1, target_index, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                    pre_transform_global_index); </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!vary_on_target) { <span class="comment">// doesn&#39;t vary on target or neighbor</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                            pre_T_staggered = prestencil_weights(1, 0, 0, pre_transform_local_index, </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                                    pre_transform_global_index); </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                        }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                    }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                <span class="keywordtype">double</span> added_value = (pre_T*gmls_value + pre_T_staggered*staggered_value_from_targets);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                Kokkos::single(Kokkos::PerTeam(teamMember), [&amp;] () {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                    output_data_block_column(target_index, j) = previous_value + added_value;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                });</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            });</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;            Kokkos::fence();</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment">    //! Generation of polynomial reconstruction coefficients by applying to data in GMLS (allocates memory for output)</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment">    //! Polynomial reconstruction coefficients exist for each target, but there are coefficients for each neighbor (a basis for all potentional input data). This function uses a particular choice of data to contract over this basis and return the polynomial reconstructions coefficients specific to this data.</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">    //! Produces a Kokkos View as output with a Kokkos memory_space provided as a template tag by the caller. </span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">    //! The data type (double* or double**) must also be specified as a template type if one wish to get a 1D </span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">    //! Kokkos View back that can be indexed into with only one ordinal.</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="comment">    //! \param sampling_data              [in] - 1D or 2D Kokkos View that has the layout #targets * columns of data. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="comment">    //! \param sro                        [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">    //! \param scalar_as_vector_if_needed [in] - If a 1D view is given, where a 2D view is expected (scalar values given where a vector was expected), then the scalar will be repeated for as many components as the vector has</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> output_data_type = <span class="keywordtype">double</span>**, <span class="keyword">typename</span> output_memory_space, <span class="keyword">typename</span> view_type_input_data, <span class="keyword">typename</span> output_array_layout = <span class="keyword">typename</span> view_type_input_data::array_layout&gt;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    Kokkos::View&lt;output_data_type, output_array_layout, output_memory_space&gt;  <span class="comment">// shares layout of input by default</span></div>
<div class="line"><a name="l00685"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#ad37226fe1e1ff2f8ba4e6a75bbc1e387">  685</a></span>&#160;            <a class="code" href="class_compadre_1_1_evaluator.html#ad37226fe1e1ff2f8ba4e6a75bbc1e387">applyFullPolynomialCoefficientsBasisToDataAllComponents</a>(view_type_input_data sampling_data, <span class="keywordtype">bool</span> scalar_as_vector_if_needed = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <span class="keyword">auto</span> local_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a21eddec4f0de93afe50788a7d0a8d29f">getLocalDimensions</a>();</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <span class="keyword">auto</span> output_dimension_of_reconstruction_space = <a class="code" href="namespace_compadre.html#a66c93cd4f9c142faf83529071196518f">calculateBasisMultiplier</a>(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a31913983e02ff263baf60a33c992463c">getReconstructionSpace</a>(), local_dimensions);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="keyword">auto</span> coefficient_matrix_dims = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#adc9c7443a7a1890a3a27308552c9bbec">getPolynomialCoefficientsDomainRangeSize</a>();</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="comment">// determines the number of columns needed for output</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordtype">int</span> output_dimensions = output_dimension_of_reconstruction_space;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keyword">typedef</span> Kokkos::View&lt;output_data_type, output_array_layout, output_memory_space&gt; output_view_type;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// create view on whatever memory space the user specified with their template argument when calling this function</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        output_view_type coefficient_output(<span class="stringliteral">&quot;output coefficients&quot;</span>, nla.getNumberOfTargets(), </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                output_dimensions*<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">getPolynomialCoefficientsSize</a>() <span class="comment">/* number of coefficients */</span>);</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160; </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        <a class="code" href="class_compadre_1_1_evaluator.html#ad37226fe1e1ff2f8ba4e6a75bbc1e387">applyFullPolynomialCoefficientsBasisToDataAllComponents</a>(coefficient_output, sampling_data, scalar_as_vector_if_needed);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160; </div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;        <span class="keywordflow">return</span> coefficient_output;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment">    //! Generation of polynomial reconstruction coefficients by applying to data in GMLS (does not allocate memory for output)</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment">    //! Polynomial reconstruction coefficients exist for each target, but there are coefficients for each neighbor (a basis for all potentional input data). This function uses a particular choice of data to contract over this basis and return the polynomial reconstructions coefficients specific to this data.</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">    //!</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">    //! Produces a Kokkos View as output with a Kokkos memory_space provided as a template tag by the caller. </span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">    //! The data type (double* or double**) must also be specified as a template type if one wish to get a 1D </span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment">    //! Kokkos View back that can be indexed into with only one ordinal.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">    //! </span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">    //! Assumptions on input data:</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">    //! \param coefficient_output         [in] - 1D or 2D Kokkos View that has the layout #targets * #coefficients. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="comment">    //! \param sampling_data              [in] - 1D or 2D Kokkos View that has the layout #targets * columns of data. Memory space for data can be host or device. </span></div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="comment">    //! \param sro                        [in] - Sampling functional from the SamplingFunctional enum</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="comment">    //! \param scalar_as_vector_if_needed [in] - If a 1D view is given, where a 2D view is expected (scalar values given where a vector was expected), then the scalar will be repeated for as many components as the vector has</span></div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="comment"></span>    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> view_type_coefficient_output, <span class="keyword">typename</span> view_type_input_data&gt;</div>
<div class="line"><a name="l00722"></a><span class="lineno"><a class="line" href="class_compadre_1_1_evaluator.html#a9259444ac900a2eec89d7946a89bfc48">  722</a></span>&#160;    <span class="keywordtype">void</span> <a class="code" href="class_compadre_1_1_evaluator.html#a9259444ac900a2eec89d7946a89bfc48">applyFullPolynomialCoefficientsBasisToDataAllComponents</a>(view_type_coefficient_output coefficient_output, </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            view_type_input_data sampling_data, <span class="keywordtype">bool</span> scalar_as_vector_if_needed = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <span class="comment">// output can be device or host</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="comment">// input can be device or host</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">// move everything to device and calculate there, then move back to host if necessary</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keyword">auto</span> global_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">getGlobalDimensions</a>();</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        <span class="keyword">auto</span> local_dimensions = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a21eddec4f0de93afe50788a7d0a8d29f">getLocalDimensions</a>();</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keyword">auto</span> output_dimension_of_reconstruction_space = <a class="code" href="namespace_compadre.html#a66c93cd4f9c142faf83529071196518f">calculateBasisMultiplier</a>(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a31913983e02ff263baf60a33c992463c">getReconstructionSpace</a>(), local_dimensions);</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        <span class="keyword">auto</span> input_dimension_of_reconstruction_space = <a class="code" href="namespace_compadre.html#a6afcac4695abb3072b35378784b4abc1">calculateSamplingMultiplier</a>(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a31913983e02ff263baf60a33c992463c">getReconstructionSpace</a>(), <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#ac55dc3ab5f95d3e923321455bb01a996">getPolynomialSamplingFunctional</a>(), local_dimensions);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keyword">auto</span> coefficient_matrix_dims = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#adc9c7443a7a1890a3a27308552c9bbec">getPolynomialCoefficientsDomainRangeSize</a>();</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        <span class="comment">// gather needed information for evaluation</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        <span class="keyword">auto</span> nla = *(<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">getNeighborLists</a>());</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160; </div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        <span class="keyword">const</span> <a class="code" href="struct_compadre_1_1_sampling_functional.html">SamplingFunctional</a> sro = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aaee5472ba7426b9f2ca764ebd0430c94">getDataSamplingFunctional</a>();</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(coefficient_output.extent(0)==(<span class="keywordtype">size_t</span>)nla.getNumberOfTargets() </div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                &amp;&amp; <span class="stringliteral">&quot;First dimension of coefficient_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment">// determines the number of columns needed for output</span></div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                coefficient_output.extent(1)==(<span class="keywordtype">size_t</span>)output_dimension_of_reconstruction_space*<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">getPolynomialCoefficientsSize</a>() </div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <span class="comment">/* number of coefficients */</span> &amp;&amp; <span class="stringliteral">&quot;Second dimension of coefficient_output is incorrect size.\n&quot;</span>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160; </div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="comment">// make sure input and output columns make sense under the target operation</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <a class="code" href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a>(((output_dimension_of_reconstruction_space==1 &amp;&amp; view_type_coefficient_output::rank==1) || view_type_coefficient_output::rank!=1) &amp;&amp; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                <span class="stringliteral">&quot;Output view is requested as rank 1, but the target requires a rank larger than 1. Try double** as template argument.&quot;</span>);</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="comment">// we need to specialize a template on the rank of the output view type and the input view type</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        <span class="keyword">auto</span> sampling_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(sampling_data, scalar_as_vector_if_needed);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keyword">auto</span> output_subview_maker = <a class="code" href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">CreateNDSliceOnDeviceView</a>(coefficient_output, <span class="keyword">false</span>); <span class="comment">// output will always be the correct dimension</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="comment">// figure out preprocessing and postprocessing</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keyword">auto</span> prestencil_weights = <a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#aff8cbcdf4715eba368b7a2d92c76b754">getPrestencilWeights</a>();</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        <span class="comment">// all loop logic based on transforming data under a sampling functional</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="comment">// into something that is valid input for GMLS</span></div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordtype">bool</span> vary_on_target = <span class="keyword">false</span>, vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keyword">auto</span> sro_style = sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">transform_type</a>;</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordtype">bool</span> loop_global_dimensions = sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#ab4e2d513c89f3adb1ad5ec2e6d5fb1fa">input_rank</a>&gt;0 &amp;&amp; sro_style!=<a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a>; </div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="keywordflow">if</span> (sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">transform_type</a> == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a> || sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">transform_type</a> == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ab13b06e20f8d36b5346a5781b7c9ce43">SameForAll</a>) {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            vary_on_target = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">transform_type</a> == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424aa96f53f2ba3817c215344f27b66da798">DifferentEachTarget</a>) {</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            vary_on_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            vary_on_neighbor = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro.<a class="code" href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">transform_type</a> == <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424a4a5f31a07809f6abad03b7d71d9f94a9">DifferentEachNeighbor</a>) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;            vary_on_target = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            vary_on_neighbor = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="comment">// written for up to rank 1 to rank 0 (in / out)</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        <span class="comment">// loop over components of output of the target operation</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;output_dimension_of_reconstruction_space; ++i) {</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_1 = i;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> output_component_axis_2 = 0;</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">// loop over components of input of the target operation</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j=0; j&lt;input_dimension_of_reconstruction_space; ++j) {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_1 = j;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> input_component_axis_2 = 0;</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160; </div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                <span class="keywordflow">if</span> (loop_global_dimensions) {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k=0; k&lt;global_dimensions; ++k) { <span class="comment">// loop for handling sampling functional</span></div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                        this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">applyFullPolynomialCoefficientsBasisToDataSingleComponent</a>(</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                output_subview_maker.get2DView(i,<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">getPolynomialCoefficientsSize</a>()), </div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                sampling_subview_maker.get1DView(k), sro, </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                                output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                                input_component_axis_2, j, k, -1, -1,</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                                vary_on_target, vary_on_neighbor);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                    }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sro_style != <a class="code" href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Identity</a>) {</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                    this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">applyFullPolynomialCoefficientsBasisToDataSingleComponent</a>(</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                            output_subview_maker.get2DView(i,<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">getPolynomialCoefficientsSize</a>()), </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                            sampling_subview_maker.get1DView(j), sro, </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                            output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                            input_component_axis_2, 0, 0, -1, -1,</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                            vary_on_target, vary_on_neighbor);</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                } <span class="keywordflow">else</span> { <span class="comment">// standard</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                    this-&gt;<a class="code" href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">applyFullPolynomialCoefficientsBasisToDataSingleComponent</a>(</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                            output_subview_maker.get2DView(i,<a class="code" href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">_gmls</a>-&gt;<a class="code" href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">getPolynomialCoefficientsSize</a>()), </div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                            sampling_subview_maker.get1DView(j), sro, </div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;                            output_component_axis_1, output_component_axis_2, input_component_axis_1, </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;                            input_component_axis_2);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                }</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            }</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        }</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        <span class="comment">// copy back to whatever memory space the user requester through templating from the device</span></div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;        Kokkos::deep_copy(coefficient_output, output_subview_maker.copyToAndReturnOriginalView());</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    }</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; </div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;}; <span class="comment">// Evaluator</span></div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160; </div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;} <span class="comment">// Compadre</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="ttc" id="a_compadre___g_m_l_s_8hpp_html"><div class="ttname"><a href="_compadre___g_m_l_s_8hpp.html">Compadre_GMLS.hpp</a></div></div>
<div class="ttc" id="a_compadre___neighbor_lists_8hpp_html"><div class="ttname"><a href="_compadre___neighbor_lists_8hpp.html">Compadre_NeighborLists.hpp</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html"><div class="ttname"><a href="_compadre___typedefs_8hpp.html">Compadre_Typedefs.hpp</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_a780a197019fb46228d76d52b97d59907"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#a780a197019fb46228d76d52b97d59907">team_policy</a></div><div class="ttdeci">Kokkos::TeamPolicy&lt; device_execution_space &gt; team_policy</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00055">Compadre_Typedefs.hpp:55</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_a7fb359b76dd16c0303cd3c673e7415de"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#a7fb359b76dd16c0303cd3c673e7415de">enable_if_t</a></div><div class="ttdeci">typename std::enable_if&lt; B, T &gt;::type enable_if_t</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00113">Compadre_Typedefs.hpp:113</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_ab6b3943cff6b6b9a98a1dc4f7c87393d"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#ab6b3943cff6b6b9a98a1dc4f7c87393d">member_type</a></div><div class="ttdeci">team_policy::member_type member_type</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00056">Compadre_Typedefs.hpp:56</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_ac42c70243721f587611ca41df3f2bbbf"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#ac42c70243721f587611ca41df3f2bbbf">device_memory_space</a></div><div class="ttdeci">device_execution_space::memory_space device_memory_space</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00051">Compadre_Typedefs.hpp:51</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_ad2e922474a1f5a3271a2fde6abd04202"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#ad2e922474a1f5a3271a2fde6abd04202">compadre_assert_debug</a></div><div class="ttdeci">#define compadre_assert_debug(condition)</div><div class="ttdoc">compadre_assert_debug is used for assertions that are checked in loops, as these significantly impact...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00161">Compadre_Typedefs.hpp:161</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_adafc59ca3001a3718b819982980451ea"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#adafc59ca3001a3718b819982980451ea">TO_GLOBAL</a></div><div class="ttdeci">#define TO_GLOBAL(variable)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00038">Compadre_Typedefs.hpp:38</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_ae10044c07bbc70fddbbb3612cb4657cc"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#ae10044c07bbc70fddbbb3612cb4657cc">scratch_matrix_right_type</a></div><div class="ttdeci">Kokkos::View&lt; double **, layout_right, Kokkos::MemoryTraits&lt; Kokkos::Unmanaged &gt; &gt; scratch_matrix_right_type</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00067">Compadre_Typedefs.hpp:67</a></div></div>
<div class="ttc" id="a_compadre___typedefs_8hpp_html_aff8e081c413b59ef75c10156c2aef649"><div class="ttname"><a href="_compadre___typedefs_8hpp.html#aff8e081c413b59ef75c10156c2aef649">compadre_assert_release</a></div><div class="ttdeci">#define compadre_assert_release(condition)</div><div class="ttdoc">compadre_assert_release is used for assertions that should always be checked, but generally are not e...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___typedefs_8hpp_source.html#l00129">Compadre_Typedefs.hpp:129</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html"><div class="ttname"><a href="class_compadre_1_1_evaluator.html">Compadre::Evaluator</a></div><div class="ttdoc">Lightweight Evaluator Helper This class is a lightweight wrapper for extracting and applying all rele...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00123">Compadre_Evaluator.hpp:123</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a094f34080746ecc1c4b3b92872280e7f"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a094f34080746ecc1c4b3b92872280e7f">Compadre::Evaluator::applyFullPolynomialCoefficientsBasisToDataSingleComponent</a></div><div class="ttdeci">void applyFullPolynomialCoefficientsBasisToDataSingleComponent(view_type_data_out output_data_block_column, view_type_data_in sampling_data_single_column, const SamplingFunctional sro, const int output_component_axis_1, const int output_component_axis_2, const int input_component_axis_1, const int input_component_axis_2, const int pre_transform_local_index=-1, const int pre_transform_global_index=-1, const int post_transform_local_index=-1, const int post_transform_global_index=-1, bool vary_on_target=false, bool vary_on_neighbor=false) const</div><div class="ttdoc">Dot product of data with full polynomial coefficient basis where sampling data is in a 1D/2D Kokkos V...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00565">Compadre_Evaluator.hpp:565</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a369b5a1a21224fb51045f0f3b132b745"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a369b5a1a21224fb51045f0f3b132b745">Compadre::Evaluator::~Evaluator</a></div><div class="ttdeci">~Evaluator()</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00136">Compadre_Evaluator.hpp:136</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a53af29898f3db02a84bb7a17ab8fb5d8"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a53af29898f3db02a84bb7a17ab8fb5d8">Compadre::Evaluator::applyAlphasToDataAllComponentsAllTargetSites</a></div><div class="ttdeci">Kokkos::View&lt; output_data_type, output_array_layout, output_memory_space &gt; applyAlphasToDataAllComponentsAllTargetSites(view_type_input_data sampling_data, TargetOperation lro, const SamplingFunctional sro_in=PointSample, bool scalar_as_vector_if_needed=true, const int evaluation_site_local_index=0) const</div><div class="ttdoc">Transformation of data under GMLS (allocates memory for output)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00370">Compadre_Evaluator.hpp:370</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a5d17f7937bdf527946dd82f22c3131ea"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a5d17f7937bdf527946dd82f22c3131ea">Compadre::Evaluator::applyLocalChartToAmbientSpaceTransform</a></div><div class="ttdeci">void applyLocalChartToAmbientSpaceTransform(view_type_data_out output_data_single_column, view_type_data_in sampling_data_single_column, const int local_dim_index, const int global_dim_index) const</div><div class="ttdoc">Postprocessing for manifolds.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00317">Compadre_Evaluator.hpp:317</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a67c605450c74a300cb3d8f511ab74fe1"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a67c605450c74a300cb3d8f511ab74fe1">Compadre::Evaluator::applyAlphasToDataSingleComponentSingleTargetSite</a></div><div class="ttdeci">double applyAlphasToDataSingleComponentSingleTargetSite(view_type_data sampling_input_data, const int column_of_input, TargetOperation lro, const int target_index, const int evaluation_site_local_index, const int output_component_axis_1, const int output_component_axis_2, const int input_component_axis_1, const int input_component_axis_2, bool scalar_as_vector_if_needed=true) const</div><div class="ttdoc">Dot product of alphas with sampling data, FOR A SINGLE target_index, where sampling data is in a 1D/2...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00156">Compadre_Evaluator.hpp:156</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a73a4d6cc3a2fbd1f2ad6d27a2f89a4f5"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a73a4d6cc3a2fbd1f2ad6d27a2f89a4f5">Compadre::Evaluator::Evaluator</a></div><div class="ttdeci">Evaluator(GMLS *gmls)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00132">Compadre_Evaluator.hpp:132</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a8401f72fae64903ae26f7ff9a20a1cc8"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a8401f72fae64903ae26f7ff9a20a1cc8">Compadre::Evaluator::applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform</a></div><div class="ttdeci">void applyAlphasToDataSingleComponentAllTargetSitesWithPreAndPostTransform(view_type_data_out output_data_single_column, view_type_data_in sampling_data_single_column, TargetOperation lro, const SamplingFunctional sro, const int evaluation_site_local_index, const int output_component_axis_1, const int output_component_axis_2, const int input_component_axis_1, const int input_component_axis_2, const int pre_transform_local_index=-1, const int pre_transform_global_index=-1, const int post_transform_local_index=-1, const int post_transform_global_index=-1, bool vary_on_target=false, bool vary_on_neighbor=false) const</div><div class="ttdoc">Dot product of alphas with sampling data where sampling data is in a 1D/2D Kokkos View and output vie...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00213">Compadre_Evaluator.hpp:213</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_a9259444ac900a2eec89d7946a89bfc48"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#a9259444ac900a2eec89d7946a89bfc48">Compadre::Evaluator::applyFullPolynomialCoefficientsBasisToDataAllComponents</a></div><div class="ttdeci">void applyFullPolynomialCoefficientsBasisToDataAllComponents(view_type_coefficient_output coefficient_output, view_type_input_data sampling_data, bool scalar_as_vector_if_needed=true) const</div><div class="ttdoc">Generation of polynomial reconstruction coefficients by applying to data in GMLS (does not allocate m...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00722">Compadre_Evaluator.hpp:722</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_ad37226fe1e1ff2f8ba4e6a75bbc1e387"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#ad37226fe1e1ff2f8ba4e6a75bbc1e387">Compadre::Evaluator::applyFullPolynomialCoefficientsBasisToDataAllComponents</a></div><div class="ttdeci">Kokkos::View&lt; output_data_type, output_array_layout, output_memory_space &gt; applyFullPolynomialCoefficientsBasisToDataAllComponents(view_type_input_data sampling_data, bool scalar_as_vector_if_needed=true) const</div><div class="ttdoc">Generation of polynomial reconstruction coefficients by applying to data in GMLS (allocates memory fo...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00685">Compadre_Evaluator.hpp:685</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_af247b7aacebd49696cdc3966f5cb6b67"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#af247b7aacebd49696cdc3966f5cb6b67">Compadre::Evaluator::applyAlphasToDataAllComponentsAllTargetSites</a></div><div class="ttdeci">void applyAlphasToDataAllComponentsAllTargetSites(view_type_output_data target_output, view_type_output_data ambient_target_output, view_type_input_data sampling_data, TargetOperation lro, const SamplingFunctional sro_in=PointSample, bool scalar_as_vector_if_needed=true, const int evaluation_site_local_index=0) const</div><div class="ttdoc">Transformation of data under GMLS (does not allocate memory for output)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00417">Compadre_Evaluator.hpp:417</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_evaluator_html_af4651172af06f6ee5f264d13e997bd68"><div class="ttname"><a href="class_compadre_1_1_evaluator.html#af4651172af06f6ee5f264d13e997bd68">Compadre::Evaluator::_gmls</a></div><div class="ttdeci">GMLS * _gmls</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00127">Compadre_Evaluator.hpp:127</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html">Compadre::GMLS</a></div><div class="ttdoc">Generalized Moving Least Squares (GMLS)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00040">Compadre_GMLS.hpp:40</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a0eccab2baa3c60e9340dc8187267cb56"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a0eccab2baa3c60e9340dc8187267cb56">Compadre::GMLS::getNeighborLists</a></div><div class="ttdeci">neighbor_lists_type * getNeighborLists() const</div><div class="ttdoc">Get neighbor list accessor.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00698">Compadre_GMLS.hpp:698</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a10a4bb458968581849f3cabf93072f5d"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a10a4bb458968581849f3cabf93072f5d">Compadre::GMLS::getPolynomialCoefficientsMemorySize</a></div><div class="ttdeci">host_managed_local_index_type getPolynomialCoefficientsMemorySize() const</div><div class="ttdoc">Returns 2D array size in memory on which coefficients are stored.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00622">Compadre_GMLS.hpp:622</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a12269d83757d5de63e5a810a3295621d"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a12269d83757d5de63e5a810a3295621d">Compadre::GMLS::getFullPolynomialCoefficientsBasis</a></div><div class="ttdeci">decltype(_RHS) getFullPolynomialCoefficientsBasis() const</div><div class="ttdoc">Get a view (device) of all polynomial coefficients basis.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00759">Compadre_GMLS.hpp:759</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a21eddec4f0de93afe50788a7d0a8d29f"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a21eddec4f0de93afe50788a7d0a8d29f">Compadre::GMLS::getLocalDimensions</a></div><div class="ttdeci">int getLocalDimensions() const</div><div class="ttdoc">Local dimension of the GMLS problem (less than global dimension if on a manifold),...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00644">Compadre_GMLS.hpp:644</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a31913983e02ff263baf60a33c992463c"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a31913983e02ff263baf60a33c992463c">Compadre::GMLS::getReconstructionSpace</a></div><div class="ttdeci">ReconstructionSpace getReconstructionSpace() const</div><div class="ttdoc">Get the reconstruction space specified at instantiation.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00778">Compadre_GMLS.hpp:778</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a3c0875badcc86299d6f9b881e4cda040"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a3c0875badcc86299d6f9b881e4cda040">Compadre::GMLS::getPolynomialCoefficientsSize</a></div><div class="ttdeci">int getPolynomialCoefficientsSize() const</div><div class="ttdoc">Returns size of the basis used in instance's polynomial reconstruction.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00616">Compadre_GMLS.hpp:616</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a4f5cddcd25f93ed4aaed0f815272511b"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a4f5cddcd25f93ed4aaed0f815272511b">Compadre::GMLS::getGlobalDimensions</a></div><div class="ttdeci">int getGlobalDimensions() const</div><div class="ttdoc">Dimension of the GMLS problem's point data (spatial description of points in ambient space),...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00641">Compadre_GMLS.hpp:641</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a680694e7642189b994fda25a55323ff5"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a680694e7642189b994fda25a55323ff5">Compadre::GMLS::getSolutionSetDevice</a></div><div class="ttdeci">decltype(_d_ss) * getSolutionSetDevice(bool alpha_validity_check=true)</div><div class="ttdoc">Get solution set on device.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00817">Compadre_GMLS.hpp:817</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a6d7af37d90db07af703332799b65737f"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a6d7af37d90db07af703332799b65737f">Compadre::GMLS::_data_sampling_functional</a></div><div class="ttdeci">SamplingFunctional _data_sampling_functional</div><div class="ttdoc">generally the same as _polynomial_sampling_functional, but can differ if specified at</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00166">Compadre_GMLS.hpp:166</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_a717252cf703df32e07c33f10b9866894"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#a717252cf703df32e07c33f10b9866894">Compadre::GMLS::_h_ss</a></div><div class="ttdeci">SolutionSet&lt; host_memory_space &gt; _h_ss</div><div class="ttdoc">Solution Set (contains all alpha values from solution and alpha layout methods)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00122">Compadre_GMLS.hpp:122</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_aaee5472ba7426b9f2ca764ebd0430c94"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#aaee5472ba7426b9f2ca764ebd0430c94">Compadre::GMLS::getDataSamplingFunctional</a></div><div class="ttdeci">SamplingFunctional getDataSamplingFunctional() const</div><div class="ttdoc">Get the data sampling functional specified at instantiation (often the same as the polynomial samplin...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00775">Compadre_GMLS.hpp:775</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_ab823746d56dcb6a87a830c3a84169b66"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#ab823746d56dcb6a87a830c3a84169b66">Compadre::GMLS::getTangentDirections</a></div><div class="ttdeci">decltype(_T) * getTangentDirections()</div><div class="ttdoc">Get a view (device) of all tangent direction bundles.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00717">Compadre_GMLS.hpp:717</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_ac55dc3ab5f95d3e923321455bb01a996"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#ac55dc3ab5f95d3e923321455bb01a996">Compadre::GMLS::getPolynomialSamplingFunctional</a></div><div class="ttdeci">SamplingFunctional getPolynomialSamplingFunctional() const</div><div class="ttdoc">Get the polynomial sampling functional specified at instantiation.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00772">Compadre_GMLS.hpp:772</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_ad62dc664f468f64c422e665b4245cbf4"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#ad62dc664f468f64c422e665b4245cbf4">Compadre::GMLS::getProblemType</a></div><div class="ttdeci">ProblemType getProblemType() const</div><div class="ttdoc">Get problem type.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00650">Compadre_GMLS.hpp:650</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_adc9c7443a7a1890a3a27308552c9bbec"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#adc9c7443a7a1890a3a27308552c9bbec">Compadre::GMLS::getPolynomialCoefficientsDomainRangeSize</a></div><div class="ttdeci">host_managed_local_index_type getPolynomialCoefficientsDomainRangeSize() const</div><div class="ttdoc">Returns (size of the basis used in instance's polynomial reconstruction) x (data input dimension)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00608">Compadre_GMLS.hpp:608</a></div></div>
<div class="ttc" id="aclass_compadre_1_1_g_m_l_s_html_aff8cbcdf4715eba368b7a2d92c76b754"><div class="ttname"><a href="class_compadre_1_1_g_m_l_s.html#aff8cbcdf4715eba368b7a2d92c76b754">Compadre::GMLS::getPrestencilWeights</a></div><div class="ttdeci">decltype(_prestencil_weights) getPrestencilWeights() const</div><div class="ttdoc">Get a view (device) of all rank 2 preprocessing tensors This is a rank 5 tensor that is able to provi...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___g_m_l_s_8hpp_source.html#l00754">Compadre_GMLS.hpp:754</a></div></div>
<div class="ttc" id="anamespace_compadre_html"><div class="ttname"><a href="namespace_compadre.html">Compadre</a></div><div class="ttdef"><b>Definition:</b> <a href="_compadre___apply_target_evaluations_8hpp_source.html#l00013">Compadre_ApplyTargetEvaluations.hpp:13</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a2b30b9fb0daa7592da0bd000bdf52fa8"><div class="ttname"><a href="namespace_compadre.html#a2b30b9fb0daa7592da0bd000bdf52fa8">Compadre::getTargetOutputTensorRank</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int getTargetOutputTensorRank(const int &amp;index)</div><div class="ttdoc">Rank of target functional output for each TargetOperation Rank of target functional input for each Ta...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00076">Compadre_Operators.hpp:76</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a5ae59f6a73748dcddcfb51fc45b23c4e"><div class="ttname"><a href="namespace_compadre.html#a5ae59f6a73748dcddcfb51fc45b23c4e">Compadre::CreateNDSliceOnDeviceView</a></div><div class="ttdeci">auto CreateNDSliceOnDeviceView(T sampling_input_data_host_or_device, bool scalar_as_vector_if_needed) -&gt; SubviewND&lt; decltype(Kokkos::create_mirror_view(device_memory_space(), sampling_input_data_host_or_device)), T &gt;</div><div class="ttdoc">Copies data_in to the device, and then allows for access to 1D columns of data on device.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00106">Compadre_Evaluator.hpp:106</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a5f6ebcec2ee2b0b9c4e5ad56432e7ffe"><div class="ttname"><a href="namespace_compadre.html#a5f6ebcec2ee2b0b9c4e5ad56432e7ffe">Compadre::PointSample</a></div><div class="ttdeci">constexpr SamplingFunctional PointSample</div><div class="ttdoc">Available sampling functionals.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00180">Compadre_Operators.hpp:180</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a66c93cd4f9c142faf83529071196518f"><div class="ttname"><a href="namespace_compadre.html#a66c93cd4f9c142faf83529071196518f">Compadre::calculateBasisMultiplier</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int calculateBasisMultiplier(const ReconstructionSpace rs, const int local_dimensions)</div><div class="ttdoc">Calculate basis_multiplier.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___misc_8hpp_source.html#l00268">Compadre_Misc.hpp:268</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a6afcac4695abb3072b35378784b4abc1"><div class="ttname"><a href="namespace_compadre.html#a6afcac4695abb3072b35378784b4abc1">Compadre::calculateSamplingMultiplier</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int calculateSamplingMultiplier(const ReconstructionSpace rs, const SamplingFunctional sro, const int local_dimensions)</div><div class="ttdoc">Calculate sampling_multiplier.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___misc_8hpp_source.html#l00276">Compadre_Misc.hpp:276</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a7bcef14eab05ce9b74e76640a660d2e3afb121947b941062d256dfa840e0c9147"><div class="ttname"><a href="namespace_compadre.html#a7bcef14eab05ce9b74e76640a660d2e3afb121947b941062d256dfa840e0c9147">Compadre::MANIFOLD</a></div><div class="ttdeci">@ MANIFOLD</div><div class="ttdoc">Solve GMLS problem on a manifold (will use QR or SVD to solve the resultant GMLS problem dependent on...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00230">Compadre_Operators.hpp:230</a></div></div>
<div class="ttc" id="anamespace_compadre_html_a9975dd29d2aabf4a76702cc95843523a"><div class="ttname"><a href="namespace_compadre.html#a9975dd29d2aabf4a76702cc95843523a">Compadre::ManifoldVectorPointSample</a></div><div class="ttdeci">constexpr SamplingFunctional ManifoldVectorPointSample</div><div class="ttdoc">Point evaluations of the entire vector source function (but on a manifold, so it includes a transform...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00187">Compadre_Operators.hpp:187</a></div></div>
<div class="ttc" id="anamespace_compadre_html_aa1c25402ec50c8e2de11d706c43e515e"><div class="ttname"><a href="namespace_compadre.html#aa1c25402ec50c8e2de11d706c43e515e">Compadre::getOutputDimensionOfOperation</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int getOutputDimensionOfOperation(TargetOperation lro, const int local_dimensions)</div><div class="ttdoc">Dimensions ^ output rank for target operation.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___misc_8hpp_source.html#l00292">Compadre_Misc.hpp:292</a></div></div>
<div class="ttc" id="anamespace_compadre_html_aa751ff7a0194083792001d714fd7f396"><div class="ttname"><a href="namespace_compadre.html#aa751ff7a0194083792001d714fd7f396">Compadre::VectorPointSample</a></div><div class="ttdeci">constexpr SamplingFunctional VectorPointSample</div><div class="ttdoc">Point evaluations of the entire vector source function.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00183">Compadre_Operators.hpp:183</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ab02c592b44da9a6eb95c99546e1191f2"><div class="ttname"><a href="namespace_compadre.html#ab02c592b44da9a6eb95c99546e1191f2">Compadre::getInputDimensionOfOperation</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int getInputDimensionOfOperation(TargetOperation lro, SamplingFunctional sro, const int local_dimensions)</div><div class="ttdoc">Dimensions ^ input rank for target operation (always in local chart if on a manifold,...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___misc_8hpp_source.html#l00298">Compadre_Misc.hpp:298</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ab90f532830fbb4deb58bf2ec4c557424a4a5f31a07809f6abad03b7d71d9f94a9"><div class="ttname"><a href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424a4a5f31a07809f6abad03b7d71d9f94a9">Compadre::DifferentEachNeighbor</a></div><div class="ttdeci">@ DifferentEachNeighbor</div><div class="ttdoc">Each target applies a different transform for each neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00137">Compadre_Operators.hpp:137</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ab90f532830fbb4deb58bf2ec4c557424aa96f53f2ba3817c215344f27b66da798"><div class="ttname"><a href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424aa96f53f2ba3817c215344f27b66da798">Compadre::DifferentEachTarget</a></div><div class="ttdeci">@ DifferentEachTarget</div><div class="ttdoc">Each target applies a different data transform, but the same to each neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00136">Compadre_Operators.hpp:136</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ab90f532830fbb4deb58bf2ec4c557424ab13b06e20f8d36b5346a5781b7c9ce43"><div class="ttname"><a href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ab13b06e20f8d36b5346a5781b7c9ce43">Compadre::SameForAll</a></div><div class="ttdeci">@ SameForAll</div><div class="ttdoc">Each neighbor for each target all apply the same transform.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00135">Compadre_Operators.hpp:135</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b"><div class="ttname"><a href="namespace_compadre.html#ab90f532830fbb4deb58bf2ec4c557424ad60da712615abc104687e4485421a61b">Compadre::Identity</a></div><div class="ttdeci">@ Identity</div><div class="ttdoc">No action performed on data before GMLS target operation.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00134">Compadre_Operators.hpp:134</a></div></div>
<div class="ttc" id="anamespace_compadre_html_ac613f05c82282085cc91ecb265feeed2"><div class="ttname"><a href="namespace_compadre.html#ac613f05c82282085cc91ecb265feeed2">Compadre::TargetOperation</a></div><div class="ttdeci">TargetOperation</div><div class="ttdoc">Available target functionals.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00019">Compadre_Operators.hpp:19</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_sampling_functional_html"><div class="ttname"><a href="struct_compadre_1_1_sampling_functional.html">Compadre::SamplingFunctional</a></div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00140">Compadre_Operators.hpp:140</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_sampling_functional_html_a68cb5999a1d8186676acbdc8b97a618d"><div class="ttname"><a href="struct_compadre_1_1_sampling_functional.html#a68cb5999a1d8186676acbdc8b97a618d">Compadre::SamplingFunctional::transform_type</a></div><div class="ttdeci">int transform_type</div><div class="ttdoc">Describes the SamplingFunction relationship to targets, neighbors.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00153">Compadre_Operators.hpp:153</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_sampling_functional_html_aabb0fc876ab4a05c221c446665af3b5c"><div class="ttname"><a href="struct_compadre_1_1_sampling_functional.html#aabb0fc876ab4a05c221c446665af3b5c">Compadre::SamplingFunctional::use_target_site_weights</a></div><div class="ttdeci">bool use_target_site_weights</div><div class="ttdoc">Whether or not the SamplingTensor acts on the target site as well as the neighbors.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00149">Compadre_Operators.hpp:149</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_sampling_functional_html_ab4e2d513c89f3adb1ad5ec2e6d5fb1fa"><div class="ttname"><a href="struct_compadre_1_1_sampling_functional.html#ab4e2d513c89f3adb1ad5ec2e6d5fb1fa">Compadre::SamplingFunctional::input_rank</a></div><div class="ttdeci">int input_rank</div><div class="ttdoc">Rank of sampling functional input for each SamplingFunctional.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___operators_8hpp_source.html#l00144">Compadre_Operators.hpp:144</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_solution_set_html_a191f63f135478c2cd76de23a14783a9e"><div class="ttname"><a href="struct_compadre_1_1_solution_set.html#a191f63f135478c2cd76de23a14783a9e">Compadre::SolutionSet::getAlphaIndex</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION global_index_type getAlphaIndex(const int target_index, const int alpha_column_offset) const</div><div class="ttdoc">Gives index into alphas given two axes, which when incremented by the neighbor number transforms acce...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___solution_set_8hpp_source.html#l00238">Compadre_SolutionSet.hpp:238</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_solution_set_html_a69f84c6ef513c569c9c6c59776cd4366"><div class="ttname"><a href="struct_compadre_1_1_solution_set.html#a69f84c6ef513c569c9c6c59776cd4366">Compadre::SolutionSet::getAlphaColumnOffset</a></div><div class="ttdeci">KOKKOS_INLINE_FUNCTION int getAlphaColumnOffset(TargetOperation lro, const int output_component_axis_1, const int output_component_axis_2, const int input_component_axis_1, const int input_component_axis_2, const int evaluation_site_local_index=0) const</div><div class="ttdoc">Retrieves the offset for an operator based on input and output component, generic to row (but still m...</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___solution_set_8hpp_source.html#l00256">Compadre_SolutionSet.hpp:256</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_a3c5f8e6060b341fad3bea4d5e2c8af8d"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a3c5f8e6060b341fad3bea4d5e2c8af8d">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::get2DView</a></div><div class="ttdeci">auto get2DView(const int column_num, const int block_size) -&gt; decltype(Kokkos::subview(_data_in, Kokkos::ALL))</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00090">Compadre_Evaluator.hpp:90</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_a4890832b84c5416c893ab84c44682a8e"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a4890832b84c5416c893ab84c44682a8e">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::_scalar_as_vector_if_needed</a></div><div class="ttdeci">bool _scalar_as_vector_if_needed</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00072">Compadre_Evaluator.hpp:72</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_a6094fbd245294e8badd6605ae304714a"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a6094fbd245294e8badd6605ae304714a">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::copyToAndReturnOriginalView</a></div><div class="ttdeci">T2 copyToAndReturnOriginalView()</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00095">Compadre_Evaluator.hpp:95</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_a680a8dc5f6de80c8514b820c45dee872"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a680a8dc5f6de80c8514b820c45dee872">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::_data_in</a></div><div class="ttdeci">T _data_in</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00070">Compadre_Evaluator.hpp:70</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_a891048802b16863e0c6aa0ed42c789dd"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#a891048802b16863e0c6aa0ed42c789dd">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::_data_original_view</a></div><div class="ttdeci">T2 _data_original_view</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00071">Compadre_Evaluator.hpp:71</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_ac13b0c0d84b86d3ea09540fe90872b78"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#ac13b0c0d84b86d3ea09540fe90872b78">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::get1DView</a></div><div class="ttdeci">auto get1DView(const int column_num) -&gt; decltype(Kokkos::subview(_data_in, Kokkos::ALL))</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00080">Compadre_Evaluator.hpp:80</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4_html_aecec7be3768b6c3c4a3cbcf1f9bd54a0"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d_3_01_t_00_01_t2_00_01enable__if__t_3_07_t_1_1rank_3_012_08_4_01_4.html#aecec7be3768b6c3c4a3cbcf1f9bd54a0">Compadre::SubviewND&lt; T, T2, enable_if_t&lt;(T::rank&lt; 2)&gt; &gt;::SubviewND</a></div><div class="ttdeci">SubviewND(T data_in, T2 data_original_view, bool scalar_as_vector_if_needed)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00074">Compadre_Evaluator.hpp:74</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html">Compadre::SubviewND</a></div><div class="ttdoc">Creates 1D subviews of data from a 2D view, generally constructed with CreateNDSliceOnDeviceView.</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00020">Compadre_Evaluator.hpp:20</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_a1790de41cf0a3333fcc3b04d636d47f0"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#a1790de41cf0a3333fcc3b04d636d47f0">Compadre::SubviewND::_data_original_view</a></div><div class="ttdeci">T2 _data_original_view</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00023">Compadre_Evaluator.hpp:23</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_a36414b557a1c5e90c23b5d194f84a4b3"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#a36414b557a1c5e90c23b5d194f84a4b3">Compadre::SubviewND::_scalar_as_vector_if_needed</a></div><div class="ttdeci">bool _scalar_as_vector_if_needed</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00024">Compadre_Evaluator.hpp:24</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_a7284ec8e1e8fdd504220bd888e9c4d49"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#a7284ec8e1e8fdd504220bd888e9c4d49">Compadre::SubviewND::SubviewND</a></div><div class="ttdeci">SubviewND(T data_in, T2 data_original_view, bool scalar_as_vector_if_needed)</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00026">Compadre_Evaluator.hpp:26</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_a7382e354c4f6108447152930112ebf1b"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#a7382e354c4f6108447152930112ebf1b">Compadre::SubviewND::get2DView</a></div><div class="ttdeci">auto get2DView(const int column_num, const int block_size) -&gt; decltype(Kokkos::subview(_data_in, Kokkos::ALL, Kokkos::make_pair(column_num *block_size,(column_num+1) *block_size)))</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00043">Compadre_Evaluator.hpp:43</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_a8a32676047f91e46d3bc18b426ee59d0"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#a8a32676047f91e46d3bc18b426ee59d0">Compadre::SubviewND::_data_in</a></div><div class="ttdeci">T _data_in</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00022">Compadre_Evaluator.hpp:22</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_aba18f59455c7ee5b83e0b774cd14a66a"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#aba18f59455c7ee5b83e0b774cd14a66a">Compadre::SubviewND::get1DView</a></div><div class="ttdeci">auto get1DView(const int column_num) -&gt; decltype(Kokkos::subview(_data_in, Kokkos::ALL, column_num))</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00032">Compadre_Evaluator.hpp:32</a></div></div>
<div class="ttc" id="astruct_compadre_1_1_subview_n_d_html_ac3d1da3c5e443aed7d45fbf939e0fb50"><div class="ttname"><a href="struct_compadre_1_1_subview_n_d.html#ac3d1da3c5e443aed7d45fbf939e0fb50">Compadre::SubviewND::copyToAndReturnOriginalView</a></div><div class="ttdeci">T2 copyToAndReturnOriginalView()</div><div class="ttdef"><b>Definition:</b> <a href="_compadre___evaluator_8hpp_source.html#l00057">Compadre_Evaluator.hpp:57</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Dec 9 2024 20:20:51 for Compadre by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
